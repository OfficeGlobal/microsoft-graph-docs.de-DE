---
title: Autorisierung und die Sicherheits-API in Microsoft Graph
description: Sicherheitsdaten, auf die über die Sicherheits-API in Microsoft Graph zugegriffen werden kann, sind vertraulich und sind sowohl durch Berechtigungen als auch durch Azure Active Directory (Azure AD)-Rollen geschützt.
author: preetikr
localization_priority: Priority
ms.prod: security
ms.openlocfilehash: 4b46df393b84c72efb40bb88d8cdeb7aca44449d
ms.sourcegitcommit: b877a8dc9aeaf74f975ca495b401ffff001d7699
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 03/08/2019
ms.locfileid: "30480425"
---
# <a name="authorization-and-the-microsoft-graph-security-api"></a><span data-ttu-id="37cc4-103">Autorisierung und die Sicherheits-API in Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="37cc4-103">Authorization and the Microsoft Graph Security API</span></span>

<span data-ttu-id="37cc4-104">Sicherheitsdaten, auf die über die Sicherheits-API in Microsoft Graph zugegriffen werden kann, sind vertraulich und sind sowohl durch Berechtigungen als auch durch Azure Active Directory (Azure AD)-Rollen geschützt.</span><span class="sxs-lookup"><span data-stu-id="37cc4-104">Security data accessible via the Microsoft Graph Security API is sensitive and protected by both permissions and Azure Active Directory (Azure AD) roles.</span></span>

<span data-ttu-id="37cc4-105">Die Sicherheits-API in Microsoft Graph unterstützt zwei Arten von Autorisierung:</span><span class="sxs-lookup"><span data-stu-id="37cc4-105">The Microsoft Graph Security API supports two types of authorization:</span></span>

- <span data-ttu-id="37cc4-106">**Autorisierung auf Anwendungsebene** – Es ist kein Benutzer angemeldet (z. B. ein SIEM-Szenario).</span><span class="sxs-lookup"><span data-stu-id="37cc4-106">**Application-level authorization** - There is no signed-in user (for example, a SIEM scenario).</span></span> <span data-ttu-id="37cc4-107">Die Berechtigungen, die der Anwendung gewährt wurden, bestimmen die Autorisierung.</span><span class="sxs-lookup"><span data-stu-id="37cc4-107">The permissions granted to the application determine authorization.</span></span> 
    ><span data-ttu-id="37cc4-108">**Hinweis:** Diese Option unterstützt auch Fälle, in denen die rollenbasierte Zugriffssteuerung (RBAC) von der Anwendung verwaltet wird.</span><span class="sxs-lookup"><span data-stu-id="37cc4-108">**Note:** This option can also support cases where Role-Based Access Control (RBAC) is managed by the application.</span></span>
- <span data-ttu-id="37cc4-109">**Benutzer-delegierte Autorisierung** – Ein Benutzer, der ein Mitglied des Azure AD-Mandanten ist, ist angemeldet.</span><span class="sxs-lookup"><span data-stu-id="37cc4-109">**User delegated authorization** - A user who is a member of the Azure AD tenant is signed in.</span></span> <span data-ttu-id="37cc4-110">Der Benutzer muss ein Mitglied einer beschränkten Azure AD-Administratorrolle sein – mit Leseberechtigung für Sicherheitsfunktionen oder Sicherheitsadministrator – zusätzlich dazu, dass der Anwendung die erforderlichen Berechtigungen erteilt wurden.</span><span class="sxs-lookup"><span data-stu-id="37cc4-110">The user must be a member of an Azure AD Limited Admin role - either Security Reader or Securty Administrator - in addition to the application having been granted the required permissions.</span></span>

<span data-ttu-id="37cc4-111">Wenn Sie die Sicherheits-API in Microsoft Graph aus Graph Explorer aufrufen:</span><span class="sxs-lookup"><span data-stu-id="37cc4-111">If you're calling the Microsoft Graph Security API from Graph Explorer:</span></span>

- <span data-ttu-id="37cc4-112">Der Azure AD-Mandantenadministrator muss explizit die erforderlichen Berechtigungen für die Graph-Explorer-Anwendung gewähren.</span><span class="sxs-lookup"><span data-stu-id="37cc4-112">The Azure AD tenant admin must explicitly grant consent for the requested permissions to the Graph Explorer application.</span></span>
- <span data-ttu-id="37cc4-113">Der Benutzer muss Mitglied einer beschränkten Azure AD-Administratorrolle (mit Leseberechtigung für Sicherheitsfunktionen oder Sicherheitsadministrator) sein.</span><span class="sxs-lookup"><span data-stu-id="37cc4-113">The user must be a member of the Security Reader Limited Admin role in Azure AD (either Security Reader or Security Administrator).</span></span>

><span data-ttu-id="37cc4-114">**Hinweis**: Graph Explorer unterstützt die Autorisierung auf Anwendungsebene nicht.</span><span class="sxs-lookup"><span data-stu-id="37cc4-114">**Note**: Graph Explorer does not support application-level authorization.</span></span>

<span data-ttu-id="37cc4-115">Wenn Sie die Sicherheits-API in Microsoft Graph aus einer benutzerdefinierten oder Ihrer eigenen Anwendung aufrufen:</span><span class="sxs-lookup"><span data-stu-id="37cc4-115">If you're calling the Microsoft Graph Security API from a custom or your own application:</span></span>

- <span data-ttu-id="37cc4-116">Der Azure AD-Mandantenadministrator muss Ihrer Anwendung explizit zustimmen.</span><span class="sxs-lookup"><span data-stu-id="37cc4-116">The Azure AD tenant admin must explicitly grant consent to your application.</span></span> <span data-ttu-id="37cc4-117">Dies ist sowohl für die Autorisierung auf Anwendungsebene als auch für benutzerdelegierte Autorisierung erforderlich.</span><span class="sxs-lookup"><span data-stu-id="37cc4-117">This is required both for application-level authorization and user delegated authorization.</span></span>
- <span data-ttu-id="37cc4-118">Wenn Sie benutzerdelegierte Autorisierung nutzen, muss der Benutzer Mitglied einer beschränkten Azure AD-Administratorrolle mit Leseberechtigung für Sicherheitsfunktionen oder Sicherheitsadministrator sein.</span><span class="sxs-lookup"><span data-stu-id="37cc4-118">If you're using user delegated authorization, the user must be a member of the Security Reader or Security Administrator Limited Admin role in Azure AD.</span></span>

## <a name="manage-authorization-in-security-api-client-applications"></a><span data-ttu-id="37cc4-119">Verwalten der Autorisierung in Sicherheits-API-Clientanwendungen</span><span class="sxs-lookup"><span data-stu-id="37cc4-119">Manage authorization in security API client applications</span></span>

<span data-ttu-id="37cc4-120">Über die Sicherheits-API in Microsoft Graph bereitgestellte Sicherheitsdaten sind vertraulich und müssen durch entsprechende Authentifizierungs- und Autorisierungsmechanismen geschützt werden.</span><span class="sxs-lookup"><span data-stu-id="37cc4-120">Security data provided via the Microsoft Graph Security API is sensitive and must be protected by appropriate authentication and authorization mechanisms.</span></span> <span data-ttu-id="37cc4-121">Die folgende Tabelle enthält die Schritte zum Registrieren und Erstellen einer Clientanwendung, die auf die Sicherheits-API in Microsoft Graph zugreifen kann.</span><span class="sxs-lookup"><span data-stu-id="37cc4-121">The following table lists the steps to register and create a client application that can access the Microsoft Graph Security API.</span></span>

| <span data-ttu-id="37cc4-122">**Wer?**</span><span class="sxs-lookup"><span data-stu-id="37cc4-122">**Who**</span></span> | <span data-ttu-id="37cc4-123">**Aktion**</span><span class="sxs-lookup"><span data-stu-id="37cc4-123">**Action**</span></span> |
|:---------------------|:------------------|
|<span data-ttu-id="37cc4-124">Anwendungsentwickler oder -besitzer</span><span class="sxs-lookup"><span data-stu-id="37cc4-124">Application developer or owner</span></span>|<span data-ttu-id="37cc4-125">Registrieren Sie die Anwendung als eine Enterprise-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="37cc4-125">Register the application as an enterprise application.</span></span>|
|<span data-ttu-id="37cc4-126">Mandantenadministrator</span><span class="sxs-lookup"><span data-stu-id="37cc4-126">Tenant admin</span></span>|<span data-ttu-id="37cc4-127">Gewähren Sie Ihrer Anwendung entsprechende Berechtigungen.</span><span class="sxs-lookup"><span data-stu-id="37cc4-127">Grant permissions to the application.</span></span>|
|<span data-ttu-id="37cc4-128">Mandantenadministrator</span><span class="sxs-lookup"><span data-stu-id="37cc4-128">Tenant admin</span></span>|<span data-ttu-id="37cc4-129">Zuweisen von Benutzerrollen.</span><span class="sxs-lookup"><span data-stu-id="37cc4-129">Assign roles to users.</span></span>|
|<span data-ttu-id="37cc4-130">Anwendungsentwickler</span><span class="sxs-lookup"><span data-stu-id="37cc4-130">Application developer</span></span>|<span data-ttu-id="37cc4-131">Melden Sie sich als Benutzer an, und verwenden Sie die Anwendung, um auf die Sicherheits-API in Microsoft Graph zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="37cc4-131">Sign in as the user and use the application to access the Microsoft Graph Security API.</span></span>|

<span data-ttu-id="37cc4-132">Die Registrierung der Anwendung definiert nur, welche Berechtigungen die Anwendung zum Ausführen braucht.</span><span class="sxs-lookup"><span data-stu-id="37cc4-132">Application registration only defines which permissions the application needs in order to run.</span></span> <span data-ttu-id="37cc4-133">Sie gewährt der Anwendung KEINE Berechtigungen.</span><span class="sxs-lookup"><span data-stu-id="37cc4-133">It does NOT grant these permissions to the application.</span></span>

<span data-ttu-id="37cc4-134">Der Azure AD-Mandantenadministrator MUSS der Anwendung die Berechtigungen explizit gewähren.</span><span class="sxs-lookup"><span data-stu-id="37cc4-134">The Azure AD tenant administrator MUST explicitly grant the permissions to the application.</span></span> <span data-ttu-id="37cc4-135">Dies muss pro Mandant erfolgen und muss *jedes Mal durchgeführt werden*, wenn die Anwendungsberechtigungen im Anwendungsregistrierungsportal geändert werden.</span><span class="sxs-lookup"><span data-stu-id="37cc4-135">This must be done per tenant and must be *performed every time* the application permissions are changed in the application registration portal.</span></span>

<span data-ttu-id="37cc4-136">Nehmen wir beispielsweise an, dass Sie eine Anwendung, zwei Azure AD-Mandanten, **T1** und **T2**, und zwei Berechtigungen, **P1** und **P2**, haben.</span><span class="sxs-lookup"><span data-stu-id="37cc4-136">For example, assume that you have an application, two Azure AD tenants, **T1** and **T2**, and two permissions, **P1** and **P2**.</span></span> <span data-ttu-id="37cc4-137">Der Autorisierungsprozess sieht folgendermaßen aus:</span><span class="sxs-lookup"><span data-stu-id="37cc4-137">The following is the authorization process:</span></span>

- <span data-ttu-id="37cc4-138">Die Anwendung registriert sich, um Berechtigung **P1** anzufordern.</span><span class="sxs-lookup"><span data-stu-id="37cc4-138">The application registers to require permission **P1**.</span></span>
- <span data-ttu-id="37cc4-139">Wenn Benutzer im Mandanten **T1** ein Azure AD-Token für diese Anwendung erhalten, enthält das Token keine Berechtigungen.</span><span class="sxs-lookup"><span data-stu-id="37cc4-139">When users in tenant **T1** get an Azure AD token for this application, the token does not contain any permissions.</span></span>
- <span data-ttu-id="37cc4-140">Azure AD-Administrator des Mandanten **T1** gewährt der Anwendung explizit Berechtigungen.</span><span class="sxs-lookup"><span data-stu-id="37cc4-140">The Azure AD admin of tenant **T1** explicitly grants permissions to the application.</span></span> <span data-ttu-id="37cc4-141">Wenn Benutzer im Mandanten **T1** ein Azure AD-Token für diese Anwendung erhalten, enthält das Token die Berechtigung **P1**.</span><span class="sxs-lookup"><span data-stu-id="37cc4-141">When users in tenant **T1** get an Azure AD token for the application, it will contain permission **P1**.</span></span>
- <span data-ttu-id="37cc4-142">Wenn Benutzer im Mandanten **T2** ein Azure AD-Token für diese Anwendung erhalten, enthält das Token keine Berechtigungen, da der Administrator des Mandanten **T2** der Anwendung noch keine Berechtigungen erteilt hat.</span><span class="sxs-lookup"><span data-stu-id="37cc4-142">When users in tenant **T2** get an Azure AD token for the application, the token does not contain any permissions - because the admin of tenant **T2** did not yet grant permissions to the application.</span></span> <span data-ttu-id="37cc4-143">Berechtigung müssen *pro Mandant* und *pro Anwendung* erteilt werden.</span><span class="sxs-lookup"><span data-stu-id="37cc4-143">Permission must be granted *per tenant* and *per application*.</span></span>
- <span data-ttu-id="37cc4-144">Die Anwendung hat ihre Registrierung geändert, sodass sie jetzt die Berechtigungen **P1** und **P2** erfordert.</span><span class="sxs-lookup"><span data-stu-id="37cc4-144">The application has its registration changed to now require permissions **P1** and **P2**.</span></span>
- <span data-ttu-id="37cc4-145">Wenn Benutzer im Mandanten **T1** ein Azure AD-Token für diese Anwendung erhalten, enthält das Token nur die Berechtigung **P1**.</span><span class="sxs-lookup"><span data-stu-id="37cc4-145">When users in tenant **T1** get an Azure AD token for the application, it only contains permission **P1**.</span></span> <span data-ttu-id="37cc4-146">Berechtigungen, die einer Anwendung gewährt werden, werden als Momentaufnahmen dessen, was gewährt wurde, aufgezeichnet. Sie *ändern sich nicht automatisch* nach der (Berechtigungs-)Änderung der Anwendungsregistrierung.</span><span class="sxs-lookup"><span data-stu-id="37cc4-146">Permissions granted to an application are recorded as snapshots of what was granted - they *do not change automatically* after the application registration (permission) changes.</span></span>
- <span data-ttu-id="37cc4-147">Der Administrator des Mandanten **T2** erteilt Berechtigungen **P1** und **P2** für die Anwendung.</span><span class="sxs-lookup"><span data-stu-id="37cc4-147">The admin of tenant **T2** grants permissions **P1** and **P2** to the application.</span></span> <span data-ttu-id="37cc4-148">Wenn nun Benutzer im Mandanten **T2** ein Azure AD-Token für diese Anwendung erhalten, enthält das Token die Berechtigungen **P1** und **P2**.</span><span class="sxs-lookup"><span data-stu-id="37cc4-148">Now, when users in tenant **T2** get an Azure AD token for the application, the token will contain permissions **P1** and **P2**.</span></span>

><span data-ttu-id="37cc4-149">**Hinweis**: Die Azure AD-Token für die Anwendung im Mandanten **T1** und die Anwendung in Mandant **T2** enthalten verschiedene Berechtigungen, da jeder Mandantenadministrator verschiedene Berechtigungen für die Anwendung erteilt hat.</span><span class="sxs-lookup"><span data-stu-id="37cc4-149">**Note**: The Azure AD tokens for the application in tenant **T1** and the application in tenant **T2** contain different permissions, because each tenant admin has granted different permissions to the application.</span></span>

- <span data-ttu-id="37cc4-150">Damit die Anwendung erneut in Mandant **T1** funktioniert, muss der Administrator des Mandanten **T1** explizit die Berechtigungen **P1** und **P2** für die Anwendung erteilen.</span><span class="sxs-lookup"><span data-stu-id="37cc4-150">To make the application work again in tenant **T1**, the admin of tenant **T1** must explicitly grant permissions **P1** and **P2** to the application.</span></span>

## <a name="register-an-application-in-the-azure-ad-v20-endpoint"></a><span data-ttu-id="37cc4-151">Registrieren einer Anwendung im Azure AD v2.0-Endpunkt</span><span class="sxs-lookup"><span data-stu-id="37cc4-151">Register an application in the Azure AD v2.0 endpoint</span></span>

<span data-ttu-id="37cc4-152">Um eine Anwendung im Azure AD v2.0-Endpunkt zu registrieren, brauchen Sie:</span><span class="sxs-lookup"><span data-stu-id="37cc4-152">To register an application to the Azure AD v2.0 endpoint, you'll need:</span></span>

- <span data-ttu-id="37cc4-153">**Anwendungsname** – Zeichenfolge für den Namen der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="37cc4-153">**Application name** - A string used for the application name.</span></span>
- <span data-ttu-id="37cc4-154">**Umleitungs-URL** – Die URL, an die die Authentifizierungsantwort von Azure AD gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="37cc4-154">**Redirect URL** - The URL where the authentication response from Azure AD is sent.</span></span> <span data-ttu-id="37cc4-155">Um zu beginnen, können Sie die Homepage der Test Client Web App verwenden.</span><span class="sxs-lookup"><span data-stu-id="37cc4-155">To start, you can use the test client web app homepage.</span></span>
- <span data-ttu-id="37cc4-156">**Erforderliche Berechtigungen** – Die Berechtigungen, die die Anwendung erfordert, um Microsoft Graph aufrufen zu können.</span><span class="sxs-lookup"><span data-stu-id="37cc4-156">**Required Permissions** - The permissions that your application requires to be able to call Microsoft Graph.</span></span>

<span data-ttu-id="37cc4-157">So registrieren Sie Ihre Anwendung</span><span class="sxs-lookup"><span data-stu-id="37cc4-157">To register your application:</span></span>

1. <span data-ttu-id="37cc4-158">Gehen Sie auf https://apps.dev.microsoft.com/, und melden Sie sich an.</span><span class="sxs-lookup"><span data-stu-id="37cc4-158">Go to https://apps.dev.microsoft.com/ and sign in.</span></span>
    ><span data-ttu-id="37cc4-159">**Hinweis**: Sie müssen kein Mandantenadministrator sein. Sie werden zur Liste **Meine Programme** weitergeleitet.</span><span class="sxs-lookup"><span data-stu-id="37cc4-159">**Note**: You don't have to be a tenant admin. You will be redirected to the **My applications** list.</span></span>
2. <span data-ttu-id="37cc4-160">Wählen Sie **App hinzufügen**, und geben Sie einen **Anwendungsnamen** ein, um eine neue Anwendung zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="37cc4-160">Choose **Add an app**, and enter an **Application Name** to create a new application.</span></span>
3. <span data-ttu-id="37cc4-161">Wählen Sie auf der Registrierungsseite für die neue Anwendung **Plattform hinzufügen** > **Web**.</span><span class="sxs-lookup"><span data-stu-id="37cc4-161">On the registration page for the new application, choose **Add Platform** > **Web**.</span></span> <span data-ttu-id="37cc4-162">Geben Sie im Feld **Umleitungs-URL** die Umleitungs-URL ein.</span><span class="sxs-lookup"><span data-stu-id="37cc4-162">In the **Redirect URL** field, enter the redirect URL.</span></span>
4. <span data-ttu-id="37cc4-163">Wählen Sie im Abschnitt **Microsoft Graph-Berechtigungen** unter **Delegierte Berechtigungen** **Hinzufügen** aus.</span><span class="sxs-lookup"><span data-stu-id="37cc4-163">In the **Microsoft Graph Permissions** section, under **Delegated Permissions**, choose **Add**.</span></span> <span data-ttu-id="37cc4-164">Wählen Sie im Dialogfeld die erforderlichen Berechtigungen.</span><span class="sxs-lookup"><span data-stu-id="37cc4-164">In the dialog box, choose the required permissions.</span></span> <span data-ttu-id="37cc4-165">Eine Liste von Berechtigungen finden Sie unter [Sicherheitsberechtigungen](permissions-reference.md#security-permissions).</span><span class="sxs-lookup"><span data-stu-id="37cc4-165">For a list of permissions, see [Security permissions](permissions-reference.md#security-permissions).</span></span>

    ><span data-ttu-id="37cc4-166">**Hinweis:** Die Microsoft Graph-Sicherheits-API erfordert den Bereich "*.Read.All" für GET-Abfragen und den Bereich "*.ReadWrite.All" für PATCH/POST/DELETE-Abfragen.</span><span class="sxs-lookup"><span data-stu-id="37cc4-166">The Microsoft Graph Security API requires the SecurityEvents.Read.All scope for GET queries, and the SecurityEvents.ReadWrite.All scope for PATCH/POST queries.</span></span>

    |<span data-ttu-id="37cc4-167">Berechtigung</span><span class="sxs-lookup"><span data-stu-id="37cc4-167">Permission</span></span> | <span data-ttu-id="37cc4-168">Entität</span><span class="sxs-lookup"><span data-stu-id="37cc4-168">Entity</span></span> | <span data-ttu-id="37cc4-169">Unterstützte Anforderungen</span><span class="sxs-lookup"><span data-stu-id="37cc4-169">Supported requests</span></span> |
    |:----------|:-------|:-------------------|
    |<span data-ttu-id="37cc4-170">SecurityActions.Read.All</span><span class="sxs-lookup"><span data-stu-id="37cc4-170">SecurityActions.Read.All</span></span>| <span data-ttu-id="37cc4-171">&bull; [securityActions](/graph/api/resources/securityaction?view=graph-rest-beta) (Vorschau)</span><span class="sxs-lookup"><span data-stu-id="37cc4-171">&bull; [securityActions](/graph/api/resources/securityaction?view=graph-rest-beta) (preview)</span></span> | <span data-ttu-id="37cc4-172">GET</span><span class="sxs-lookup"><span data-stu-id="37cc4-172">GET</span></span> |
    |<span data-ttu-id="37cc4-173">SecurityActions.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="37cc4-173">SecurityActions.ReadWrite.All</span></span>| <span data-ttu-id="37cc4-174">&bull; [securityActions](/graph/api/resources/securityaction?view=graph-rest-beta) (Vorschau)</span><span class="sxs-lookup"><span data-stu-id="37cc4-174">&bull; [securityActions](/graph/api/resources/securityaction?view=graph-rest-beta) (preview)</span></span> | <span data-ttu-id="37cc4-175">GET, POST</span><span class="sxs-lookup"><span data-stu-id="37cc4-175">Get post</span></span> |
    |<span data-ttu-id="37cc4-176">SecurityEvents.Read.All</span><span class="sxs-lookup"><span data-stu-id="37cc4-176">SecurityEvents.Read.All</span></span> | <span data-ttu-id="37cc4-177">&bull; [alerts](/graph/api/resources/alert?view=graph-rest-1.0)</span><span class="sxs-lookup"><span data-stu-id="37cc4-177">Alerts</span></span></br> <span data-ttu-id="37cc4-178">&bull; [secureScores](/graph/api/resources/securescores?view=graph-rest-beta) (Vorschau)</span><span class="sxs-lookup"><span data-stu-id="37cc4-178">List secureScores (preview)</span></span></br> <span data-ttu-id="37cc4-179">&bull; [secureScoreControlProfiles](/graph/api/resources/securescorecontrolprofiles?view=graph-rest-beta) (Vorschau)</span><span class="sxs-lookup"><span data-stu-id="37cc4-179">Update secureScoreControlProfiles (preview)</span></span> | <span data-ttu-id="37cc4-180">GET</span><span class="sxs-lookup"><span data-stu-id="37cc4-180">GET</span></span> |
    |<span data-ttu-id="37cc4-181">SecurityEvents.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="37cc4-181">SecurityEvents.ReadWrite.All</span></span> | <span data-ttu-id="37cc4-182">&bull; [alerts](/graph/api/resources/alert?view=graph-rest-1.0)</span><span class="sxs-lookup"><span data-stu-id="37cc4-182">Alerts</span></span></br> <span data-ttu-id="37cc4-183">&bull; [secureScores](/graph/api/resources/securescores?view=graph-rest-beta) (Vorschau)</span><span class="sxs-lookup"><span data-stu-id="37cc4-183">List secureScores (preview)</span></span></br> <span data-ttu-id="37cc4-184">&bull; [secureScoreControlProfiles](/graph/api/resources/securescorecontrolprofiles?view=graph-rest-beta) (Vorschau)</span><span class="sxs-lookup"><span data-stu-id="37cc4-184">Update secureScoreControlProfiles (preview)</span></span> | <span data-ttu-id="37cc4-185">GET, POST, PATCH</span><span class="sxs-lookup"><span data-stu-id="37cc4-185">GET, POST, PATCH</span></span> |
    |<span data-ttu-id="37cc4-186">ThreatIndicators.ReadWrite.OwnedBy</span><span class="sxs-lookup"><span data-stu-id="37cc4-186">ThreatIndicators.ReadWrite.OwnedBy</span></span> | <span data-ttu-id="37cc4-187">&bull; [tiIndicator](/graph/api/resources/tiindicator?view=graph-rest-beta) (Vorschau)</span><span class="sxs-lookup"><span data-stu-id="37cc4-187">&bull; [tiIndicator](/graph/api/resources/tiindicator?view=graph-rest-beta) (preview)</span></span> | <span data-ttu-id="37cc4-188">GET, POST, PATCH, DELETE</span><span class="sxs-lookup"><span data-stu-id="37cc4-188">GET, POST, PATCH, DELETE</span></span>|

5. <span data-ttu-id="37cc4-189">Wählen Sie **Speichern** aus.</span><span class="sxs-lookup"><span data-stu-id="37cc4-189">Choose **Save**.</span></span>

<span data-ttu-id="37cc4-190">Speichern Sie die folgenden Informationen:</span><span class="sxs-lookup"><span data-stu-id="37cc4-190">Save the following information:</span></span>

- <span data-ttu-id="37cc4-191">Anwendungs-ID</span><span class="sxs-lookup"><span data-stu-id="37cc4-191">Application ID</span></span>
- <span data-ttu-id="37cc4-192">Umleitungs-URL</span><span class="sxs-lookup"><span data-stu-id="37cc4-192">Redirect URL</span></span>
- <span data-ttu-id="37cc4-193">Liste der erforderlichen Berechtigungen</span><span class="sxs-lookup"><span data-stu-id="37cc4-193">List of required permissions</span></span>

<span data-ttu-id="37cc4-194">Weitere Informationen finden Sie unter: [Registrieren Ihrer App beim Azure AD v2.0-Endpunkt](auth-register-app-v2.md).</span><span class="sxs-lookup"><span data-stu-id="37cc4-194">For more information, see [Register your app with the Azure AD v2.0 endpoint](auth-register-app-v2.md).</span></span>

## <a name="grant-permissions-to-an-application"></a><span data-ttu-id="37cc4-195">Gewähren von Berechtigungen für eine Anwendung</span><span class="sxs-lookup"><span data-stu-id="37cc4-195">Grant permissions to an application</span></span>

<span data-ttu-id="37cc4-196">Die Anwendungsregistrierung definiert nur, welche Berechtigungen die Anwendung erfordert. Sie gewährt der Anwendung diese Berechtigungen NICHT.</span><span class="sxs-lookup"><span data-stu-id="37cc4-196">Application registration only defines which permission the application requires - it does not grant these permissions to the application.</span></span> <span data-ttu-id="37cc4-197">Ein Azure AD-Mandantenadministrator muss diese Berechtigungen explizit gewähren, indem er den Endpunkt für die Administratorzustimmung aufruft.</span><span class="sxs-lookup"><span data-stu-id="37cc4-197">An Azure AD tenant administrator must explicitly grant these permissions by making a call to the admin consent endpoint.</span></span> <span data-ttu-id="37cc4-198">Einzelheiten hierzu finden Sie unter [Verwenden des Endpunkts für die Administratorzustimmung](https://docs.microsoft.com/de-DE/azure/active-directory/develop/active-directory-v2-scopes#using-the-admin-consent-endpoint).</span><span class="sxs-lookup"><span data-stu-id="37cc4-198">For details, see [Using the admin consent endpoint](https://docs.microsoft.com/de-DE/azure/active-directory/develop/active-directory-v2-scopes#using-the-admin-consent-endpoint).</span></span>

<span data-ttu-id="37cc4-199">Um einer Anwendung Berechtigungen zu gewähren, brauchen Sie:</span><span class="sxs-lookup"><span data-stu-id="37cc4-199">To grant permissions to an application, you'll need:</span></span>

- <span data-ttu-id="37cc4-200">**Anwendungs-ID** – Die Anwendungs-ID, die Ihrer App vom App-Registrierungsportal zugewiesen wurde.</span><span class="sxs-lookup"><span data-stu-id="37cc4-200">**Application ID** - The application ID from application registration portal.</span></span>
- <span data-ttu-id="37cc4-201">**Umleitungs-URL** – Die Zeichenfolge, die Sie im App-Registrierungsportal für die Authentifizierungsantwort festgelegt haben.</span><span class="sxs-lookup"><span data-stu-id="37cc4-201">**Redirect URL** - The string you set in the application registration portal for authentication response.</span></span>

<span data-ttu-id="37cc4-202">So gewähren Sie Berechtigungen</span><span class="sxs-lookup"><span data-stu-id="37cc4-202">To grant the permissions:</span></span>

- <span data-ttu-id="37cc4-203">Erstellen Sie in einem Texteditor die folgende URL-Zeichenfolge:</span><span class="sxs-lookup"><span data-stu-id="37cc4-203">In a text editor, create following URL string:</span></span>

    `https://login.microsoftonline.com/common/adminconsent?client_id=<Application Id>&state=12345&redirect_uri=<Redirect URL>`

- <span data-ttu-id="37cc4-204">Rufen Sie in einem Webbrowser diese URL auf, und melden Sie sich als Mandantenadministrator an.</span><span class="sxs-lookup"><span data-stu-id="37cc4-204">In a web browser, go to this URL, and sign in as a tenant administrator.</span></span> <span data-ttu-id="37cc4-205">Das Dialogfeld zeigt die Liste der Berechtigungen, die die Anwendung erfordert, wie im App-Registrierungsportal eingegeben.</span><span class="sxs-lookup"><span data-stu-id="37cc4-205">The dialog box shows the list of permission the application requires, as specified in the application registration portal.</span></span> <span data-ttu-id="37cc4-206">Wählen Sie **OK**, um der Anwendung diese Berechtigungen zu erteilen.</span><span class="sxs-lookup"><span data-stu-id="37cc4-206">Choose **OK** to grant the application these permissions.</span></span>

> <span data-ttu-id="37cc4-207">**Hinweis:** Dieser Schritt erteilt Berechtigungen an die Anwendung – nicht an den Benutzer.</span><span class="sxs-lookup"><span data-stu-id="37cc4-207">**Note:** This step grants permissions to the application - not to users.</span></span> <span data-ttu-id="37cc4-208">Das bedeutet, dass alle Benutzer, die zum Azure AD-Mandanten gehören, die diese Anwendung verwenden, diese Berechtigungen erhalten – sogar Benutzer ohne Administratorberechtigung.</span><span class="sxs-lookup"><span data-stu-id="37cc4-208">This means that all users belonging to the Azure AD tenant that use this application will be granted these permissions - even non-admin users.</span></span>

## <a name="assign-azure-ad-roles-to-users"></a><span data-ttu-id="37cc4-209">Zuweisen von Azure AD-Rollen für Benutzer</span><span class="sxs-lookup"><span data-stu-id="37cc4-209">Assign Azure AD roles to users</span></span>

<span data-ttu-id="37cc4-210">Nachdem einer Anwendung Berechtigungen erteilt wurden, erhalten alle Benutzer, die Zugriff auf die Anwendung (d. h. Mitglieder des Azure AD-Mandanten) die Berechtigungen, die erteilt wurden.</span><span class="sxs-lookup"><span data-stu-id="37cc4-210">After an application is granted permissions, everyone with access to the application (that is, members of the Azure AD tenant) will receive the granted permissions.</span></span> <span data-ttu-id="37cc4-211">Um vertrauliche Daten zusätzlich zu schützen, verlangt die Sicherheits-API in Microsoft Graph, dass Benutzern die Azure AD-Rolle **Benutzer mit Leseberechtigung für Sicherheitsfunktionen** zugewiesen wird.</span><span class="sxs-lookup"><span data-stu-id="37cc4-211">To further protect sensitive security data, the Microsoft Graph Security API also requires users to be assigned the Azure AD **Security Reader** role.</span></span> <span data-ttu-id="37cc4-212">Einzelheiten hierzu finden Sie unter [Zuweisen von Administratorrollen](https://docs.microsoft.com/de-DE/azure/active-directory/active-directory-assign-admin-roles-azure-portal) und [Zuweisen eines Benutzers zu Administratorrollen](https://docs.microsoft.com/de-DE/azure/active-directory/active-directory-users-assign-role-azure-portal).</span><span class="sxs-lookup"><span data-stu-id="37cc4-212">For details, see [Assigning administrator roles](https://docs.microsoft.com/de-DE/azure/active-directory/active-directory-assign-admin-roles-azure-portal) and [Assign a user to adminstrator roles](https://docs.microsoft.com/de-DE/azure/active-directory/active-directory-users-assign-role-azure-portal).</span></span>

><span data-ttu-id="37cc4-213">**Hinweis:** Sie müssen Mandantenadministrator sein, um diesen Schritt auszuführen.</span><span class="sxs-lookup"><span data-stu-id="37cc4-213">**Note:** You must be a tenant admin to perform this step.</span></span>

<span data-ttu-id="37cc4-214">So weisen Sie Benutzern Rollen zu</span><span class="sxs-lookup"><span data-stu-id="37cc4-214">To assign roles to users:</span></span>

- <span data-ttu-id="37cc4-215">Melden Sie sich beim [Azure-Portal](https://portal.azure.com)an.(https://portal.azure.com)</span><span class="sxs-lookup"><span data-stu-id="37cc4-215">Sign in to the [azure portal](https://portal.azure.com) (https://portal.azure.com).</span></span>
- <span data-ttu-id="37cc4-216">Wählen Sie im Menü **Azure Active Directory** > **Benutzer**.</span><span class="sxs-lookup"><span data-stu-id="37cc4-216">In the menu, select **Azure Active Directory** > **Users**.</span></span>
- <span data-ttu-id="37cc4-217">Wählen Sie den Namen des Benutzers aus.</span><span class="sxs-lookup"><span data-stu-id="37cc4-217">Select the name of the user.</span></span>
- <span data-ttu-id="37cc4-218">Wählen Sie **Verwalten** > **Directory-Rolle**.</span><span class="sxs-lookup"><span data-stu-id="37cc4-218">Select **Manage** > **Directory role**.</span></span>
- <span data-ttu-id="37cc4-219">Wählen Sie **Eingeschränkter Administrator**, und wählen Sie das Kontrollkästchen **Benutzer mit Leseberechtigung für Sicherheitsfunktionen** aus.</span><span class="sxs-lookup"><span data-stu-id="37cc4-219">Select **Limited administrator**, and choose the **Security reader** check box.</span></span>
- <span data-ttu-id="37cc4-220">Wählen Sie **Speichern** aus.</span><span class="sxs-lookup"><span data-stu-id="37cc4-220">Choose **Save**.</span></span>

## <a name="create-an-authentication-code"></a><span data-ttu-id="37cc4-221">Erstellen eines Authentifizierungscodes</span><span class="sxs-lookup"><span data-stu-id="37cc4-221">Create an authentication code</span></span>

<span data-ttu-id="37cc4-222">Um einen Authentifizierungscode zu erstellen, brauchen Sie:</span><span class="sxs-lookup"><span data-stu-id="37cc4-222">To create an authentication code, you'll need:</span></span>

- <span data-ttu-id="37cc4-223">**Anwendungs-ID** – Die Anwendungs-ID, die Ihrer App vom App-Registrierungsportal zugewiesen wurde.</span><span class="sxs-lookup"><span data-stu-id="37cc4-223">**Application ID** - The application ID from application registration portal.</span></span>
- <span data-ttu-id="37cc4-224">**Umleitungs-URL** – Die URL, an die die Authentifizierungsantwort von Azure AD gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="37cc4-224">**Redirect URL** - The URL where the authentication response from Azure AD is sent.</span></span> <span data-ttu-id="37cc4-225">Zum Beginnen können Sie https://localhost oder die Homepage der Test Client Web App verwenden.</span><span class="sxs-lookup"><span data-stu-id="37cc4-225">To start, you can use https://localhost or the test client web app homepage.</span></span>
- <span data-ttu-id="37cc4-226">**Anwendungsschlüssel** (optional) — Der Schlüssel der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="37cc4-226">**Application Key** (optional) - The key of the application.</span></span> <span data-ttu-id="37cc4-227">Dies gilt, wenn Sie eine Anwendung entwickeln, die Nur-App-Authentifizierungscodes verwendet (d. h. delegierte Benutzerauthentifizierung nicht unterstützt).</span><span class="sxs-lookup"><span data-stu-id="37cc4-227">This applies when you're developing an application that will use application-only authentication code (that is, will not support user delegated authentication).</span></span>

<span data-ttu-id="37cc4-228">Die folgende Tabelle enthält Ressourcen, die Sie zum Erstellen eines Authentifizierungscodes verwenden können.</span><span class="sxs-lookup"><span data-stu-id="37cc4-228">The following table lists resources that you can use to create an authentication code.</span></span>

|<span data-ttu-id="37cc4-229">**Art der Anwendung**</span><span class="sxs-lookup"><span data-stu-id="37cc4-229">**Type of application**</span></span>|<span data-ttu-id="37cc4-230">**Authentifizierungsbibliothek**</span><span class="sxs-lookup"><span data-stu-id="37cc4-230">**Authentication library**</span></span>|
|------------------------|----------------------------|
|[<span data-ttu-id="37cc4-231">Desktop-Apps – iOS</span><span class="sxs-lookup"><span data-stu-id="37cc4-231">Desktop apps - iOS</span></span>](https://docs.microsoft.com/de-DE/azure/active-directory/develop/guidedsetups/active-directory-ios)|[<span data-ttu-id="37cc4-232">MSAL.framework: Microsoft-Authentifizierungsbibliothek (Vorschau) für iOS</span><span class="sxs-lookup"><span data-stu-id="37cc4-232">MSAL.framework: Microsoft Authentication Library Preview for iOS</span></span>](https://github.com/AzureAD/microsoft-authentication-library-for-objc)|
|[<span data-ttu-id="37cc4-233">Desktop-Apps – Android</span><span class="sxs-lookup"><span data-stu-id="37cc4-233">Desktop apps - Android</span></span>](https://docs.microsoft.com/de-DE/azure/active-directory/develop/guidedsetups/active-directory-android)|[<span data-ttu-id="37cc4-234">Microsoft-Authentifizierungsbibliothek (MSAL)</span><span class="sxs-lookup"><span data-stu-id="37cc4-234">Microsoft Authentication Library (MSAL)</span></span>](https://javadoc.io/doc/com.microsoft.identity.client/msal)|
|[<span data-ttu-id="37cc4-235">Desktop-Apps – .NET</span><span class="sxs-lookup"><span data-stu-id="37cc4-235">Desktop apps - .Net</span></span>](https://docs.microsoft.com/de-DE/azure/active-directory/develop/guidedsetups/active-directory-windesktop)|[<span data-ttu-id="37cc4-236">Microsoft-Authentifizierungsbibliothek (MSAL)</span><span class="sxs-lookup"><span data-stu-id="37cc4-236">Microsoft Authentication Library (MSAL)</span></span>](https://www.nuget.org/packages/Microsoft.Identity.Client)|
|[<span data-ttu-id="37cc4-237">Web-Apps — JavaScript SPA</span><span class="sxs-lookup"><span data-stu-id="37cc4-237">Web apps - JavaScript SPA</span></span>](https://docs.microsoft.com/de-DE/azure/active-directory/develop/guidedsetups/active-directory-javascriptspa)|[<span data-ttu-id="37cc4-238">Microsoft-Authentifizierungsbibliothek für JavaScript (Vorschau)</span><span class="sxs-lookup"><span data-stu-id="37cc4-238">Microsoft Authentication Library for JavaScript Preview</span></span>](https://github.com/AzureAD/microsoft-authentication-library-for-js)|
|[<span data-ttu-id="37cc4-239">Web-Apps — .NET-Webserver</span><span class="sxs-lookup"><span data-stu-id="37cc4-239">Web apps - .NET Web Server</span></span>](https://docs.microsoft.com/de-DE/azure/active-directory/develop/guidedsetups/active-directory-aspnetwebapp)|<span data-ttu-id="37cc4-240">OpenIdConnection, Cookies, SystemWeb</span><span class="sxs-lookup"><span data-stu-id="37cc4-240">OpenIdConnection, Cookies, SystemWeb</span></span>|
|[<span data-ttu-id="37cc4-241">Web-Apps - NodeJS-Web-App</span><span class="sxs-lookup"><span data-stu-id="37cc4-241">Web apps - NodeJS Web App</span></span>](https://docs.microsoft.com/de-DE/azure/active-directory/develop/active-directory-v2-devquickstarts-node-web)||

<span data-ttu-id="37cc4-242">Für Anwendungen, die keine der vorhandenen Bibliotheken verwenden, siehe [Im Namen eines Benutzers zugreifen](auth-v2-user.md).</span><span class="sxs-lookup"><span data-stu-id="37cc4-242">For applications that don't use any of the existing libraries, see [Get access on behalf of a user](auth-v2-user.md).</span></span>

1. <span data-ttu-id="37cc4-243">Abrufen eines Codes von Azure AD.</span><span class="sxs-lookup"><span data-stu-id="37cc4-243">Get a code from Azure AD.</span></span> <span data-ttu-id="37cc4-244">Die Abfrage zum Aufruf enthält die Parameter für die Anwendungs-ID, Umleitungs-URL und **erforderliche Berechtigungen**.</span><span class="sxs-lookup"><span data-stu-id="37cc4-244">The query to call contains parameter for Application ID, Redirect URl, and **required permissions**.</span></span>
2. <span data-ttu-id="37cc4-245">Verwenden des Codes zum Abrufen eines Zugriffstokens.</span><span class="sxs-lookup"><span data-stu-id="37cc4-245">Use the code to get an access token.</span></span>

<span data-ttu-id="37cc4-246">Wenn Sie die OpenID Connect-Bibliothek verwenden, lesen Sie [Authentifizieren mithilfe von Azure Active Directory und OpenID Connect](https://docs.microsoft.com/de-DE/azure/architecture/multitenant-identity/authenticate), und rufen Sie `app.UseOpenIdConnectAuthentication()` auf.</span><span class="sxs-lookup"><span data-stu-id="37cc4-246">If you use OpenId Connect library, see [Authenticate using Azure AD and OpenID Connect](https://docs.microsoft.com/de-DE/azure/architecture/multitenant-identity/authenticate) and call `app.UseOpenIdConnectAuthentication()`.</span></span>

><span data-ttu-id="37cc4-247">**Hinweis:** Wenn Sie benutzerdelegierte Authentifizierungstoken anfordern, ist der Parameter für die Bibliothek **angeforderte Bereiche**.</span><span class="sxs-lookup"><span data-stu-id="37cc4-247">**Note:** If you're requesting user delegated authentication tokens, the parameter for the library is **Requested Scopes**.</span></span> <span data-ttu-id="37cc4-248">Verwenden Sie User.Read für diesen Parameter statt den Anforderungen der registrierten Anwendung.</span><span class="sxs-lookup"><span data-stu-id="37cc4-248">Use User.Read for this parameter instead of what the registered application requires.</span></span> <span data-ttu-id="37cc4-249">Der Parameter **angeforderte Bereiche** hat keinen Einfluss auf die Berechtigungen, die in den zurückgegebenen Authentifizierungstoken enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="37cc4-249">The **Requested Scopes** parameter does NOT affect the permissions contained in the returned authentication tokens.</span></span> <span data-ttu-id="37cc4-250">Diese werden durch die Berechtigungen bestimmt, die der Mandantenadministrator der Anwendung erteilt.</span><span class="sxs-lookup"><span data-stu-id="37cc4-250">These are determined by the permissions that the tenant admin granted the application.</span></span>

<span data-ttu-id="37cc4-251">Wenn Sie beispielsweise die Bibliothek .NET MSAL verwenden, rufen Sie die folgenden auf:</span><span class="sxs-lookup"><span data-stu-id="37cc4-251">For example, if you're using the .NET MSAL library, call the following:</span></span>

`var accessToken = (await client.AcquireTokenAsync(scopes)).AccessToken;`

><span data-ttu-id="37cc4-252">**Hinweis:** Dieses Beispiel sollte die geringsten Berechtigungen, z. B. User.Read, verwenden.</span><span class="sxs-lookup"><span data-stu-id="37cc4-252">**Note:** This example should use the least privileged permission, such as User.Read.</span></span> <span data-ttu-id="37cc4-253">Das zurückgegebene Zugriffstoken kann jedoch Berechtigungen enthalten, die dem aktuellen Benutzer vom Mandantenadministrator gewährt wurden, z. B. User.Read.All oder User.ReadWrite.All.</span><span class="sxs-lookup"><span data-stu-id="37cc4-253">However, the returned access token can contain permissions that were granted by the tenant admin for the current user tenant, such as User.Read.All or User.ReadWrite.All.</span></span>

<span data-ttu-id="37cc4-254">Ein Token (Zeichenfolge) wird von Azure AD zurückgegeben, das Ihre Authentifizierungsinformation und die von der Anwendung benötigten Berechtigungen enthält.</span><span class="sxs-lookup"><span data-stu-id="37cc4-254">A token (string) is returned by Azure AD that contains your authentication information and the permissions required by the application.</span></span> <span data-ttu-id="37cc4-255">Weisen Sie dieses Token dem HTTP-Header als Bearer-Token zu, wie im folgenden Beispiel gezeigt.</span><span class="sxs-lookup"><span data-stu-id="37cc4-255">Assign this token to the HTTP header as a bearer token, as shown in the following example.</span></span>

`request.Headers.Authorization = new AuthenticationHeaderValue("bearer", accessToken);`

<span data-ttu-id="37cc4-256">Microsoft Graph wird die in diesem Token enthaltenen Informationen überprüfen und den Zugriff gewähren oder ablehnen.</span><span class="sxs-lookup"><span data-stu-id="37cc4-256">Microsoft Graph will validate the information contained in this token and grant, or reject, access.</span></span>

<span data-ttu-id="37cc4-257">Um die Ansprüche zu sehen, die in den zurückgegebenen Token enthaltenen sind, verwenden Sie die NuGet-Bibliothek System.IdentityModel.Tokens.Jwt.</span><span class="sxs-lookup"><span data-stu-id="37cc4-257">To view claims contained in the returned token, use NuGet library System.IdentityModel.Tokens.Jwt.</span></span>

`JwtSecurityTokenHandler tokenHandler = new JwtSecurityTokenHandler();`</br>
`var securityToken = tokenHandler.ReadToken(accessToken) as JwtSecurityToken;`

<span data-ttu-id="37cc4-258">Die Antwort von Microsoft Graph enthält eine Kopfzeile, die-Client-Anforderungs-ID heißt und eine GUID ist.</span><span class="sxs-lookup"><span data-stu-id="37cc4-258">The response from Microsoft Graph contains a header called client-request-id, which is a GUID.</span></span> <span data-ttu-id="37cc4-259">Wenn der Zugriff verweigert wird, geben Sie diese GUID bei Supportanfragen in der [Microsoft Tech Community](https://techcommunity.microsoft.com/t5/Microsoft-Graph-Security-API/ct-p/SecurityGraphAPI) an, damit wir Ihnen helfen können, die Ursache für diesen Authentifizierungsfehler zu untersuchen.</span><span class="sxs-lookup"><span data-stu-id="37cc4-259">If access is denied, please specify this GUID when seeking support at [Microsoft Tech Community](https://techcommunity.microsoft.com/t5/Microsoft-Graph-Security-API/ct-p/SecurityGraphAPI), so we can help investigate the cause of this authentication failure.</span></span>
